import StarWebRTC from './star_rtc_video.min'
var StarRtc=window.NameSpace||{};if(void 0===APP_PRODUCT_ID)var i=0,APP_PRODUCT_ID={R:i++,t:i++,O:i++,_:i++,s:i++,S:i++,i:i++,I:i++,o:i++,A:i++,N:i++};if(void 0===ACTION_GROUP_ID){i=0;var ACTION_GROUP_ID={M:i++,V:i++,C:i++,u:i++,T:i++,P:i++}}if(void 0===MSG_TYPE){i=0;var MSG_TYPE={L:i++,G:i++,l:i++,p:i++,D:i++}}if(void 0===MSG_DATA_TYPE){i=0;var MSG_DATA_TYPE={U:i++,v:i++,H:i++,k:i++}}if(void 0===ENCRYPT_TYPE){i=0;var ENCRYPT_TYPE={m:i++,g:i++}}if(void 0===AG_MSG_VOIP_CTRL)var AG_MSG_VOIP_CTRL={h:1e3,Y:1100,F:1001,K:1002,W:1003,B:1004};if(void 0===CHATROOM_LIST_TYPE){i=0;var CHATROOM_LIST_TYPE={CHATROOM_LIST_TYPE_CHATROOM:i++,CHATROOM_LIST_TYPE_LIVE:i++,CHATROOM_LIST_TYPE_LIVE_PUSH:i++,CHATROOM_LIST_TYPE_MEETING:i++,CHATROOM_LIST_TYPE_MEETING_PUSH:i++,CHATROOM_LIST_TYPE_CLASS:i++,CHATROOM_LIST_TYPE_CLASS_PUSH:i++,CHATROOM_LIST_TYPE_AUDIO_LIVE:i++,CHATROOM_LIST_TYPE_AUDIO_LIVE_PUSH:i++,CHATROOM_LIST_TYPE_SUPER_ROOM:i++,CHATROOM_LIST_TYPE_SUPER_ROOM_PUSH:i++}}if(StarRtc.CHATROOM_LIST_TYPE=CHATROOM_LIST_TYPE,void 0===AG_MSG){i=0;var AG_MSG={q:i++,J:i++,j:i++,X:i++,Z:i++,$:i++,ee:i++,Re:i++,te:i++,Oe:i++,ae:i++,Ee:i++,_e:i++,ne:i++,se:i++,re:i++,ce:i++,Se:i++,ie:i++,Ie:i++,oe:i++,Ae:i++,Ne:i++,Me:i++,Ve:i++,Ce:i++,ue:i++,Te:i++,Pe:i++,Le:i++,Ge:i++,le:i++,fe:i++,pe:i++,De:i++,Ue:i++,de:i++,ve:i++,be:i++,He:i++,ke:i++,me:i++,ge:i++,we:i++,ye:i++}}if(void 0===CHAT_ROOM_TYPE){i=1;var CHAT_ROOM_TYPE={he:i++,xe:i++}}if(void 0===AG_CHATROOMMOONSERVER){i=0;var AG_CHATROOMMOONSERVER={Ye:i++,Fe:i++,Ke:i++,We:i++,Be:i++,qe:i++,Je:i++,Qe:i++,je:i++,Xe:i++,ze:i++,Ze:i++,$e:i++,eR:i++,RR:i++,tR:i++,OR:i++,aR:i++,ER:i++,_R:i++,nR:i++,sR:i++,rR:i++,cR:i++,SR:i++,iR:i++,IR:i++,oR:i++,AR:i++,NR:i++,MR:i++,VR:i++,CR:i++,uR:i++,TR:i++,PR:i++,LR:i++,GR:i++,lR:i++,fR:i++,pR:i++,DR:i++,UR:i++,dR:i++,vR:i++}}if(void 0===AG_VOIPMOONSERVER){i=0;var AG_VOIPMOONSERVER={bR:i++,HR:i++,kR:i++,mR:i++,gR:i++,wR:i++,yR:i++,hR:i++,xR:i++,YR:i++,FR:i++,KR:i++,WR:i++,BR:i++,qR:i++,JR:i++,QR:i++,jR:i++,XR:i++,zR:i++,ZR:i++,$R:i++,et:i++,Rt:i++,tt:i++,Ot:i++,at:i++,Et:i++,_t:i++,nt:i++,st:i++,rt:i++,ct:i++,St:i++,it:i++,It:i++,ot:i++,At:i++,Nt:i++}}if(void 0===AG_LIVESRCMOONSERVER){i=0;var AG_LIVESRCMOONSERVER={Mt:i++,Vt:i++,Ct:i++,ut:i++,Tt:i++,Pt:i++,Lt:i++,Gt:i++,lt:i++,ft:i++,pt:i++,Dt:i++,Ut:i++,dt:i++,vt:i++,bt:i++,Ht:i++,kt:i++,gt:i++,wt:i++,yt:i++,ht:i++,xt:i++,Yt:i++,Ft:i++,Kt:i++,Wt:i++,Bt:i++,qt:i++,Jt:i++,Qt:i++,jt:i++,Xt:i++,zt:i++,Zt:i++,$t:i++,eO:i++,RO:i++,tO:i++,OO:i++,aO:i++,EO:i++,_O:i++,nO:i++,sO:i++,rO:i++,cO:i++,SO:i++,iO:i++,IO:i++,oO:i++,AO:i++,NO:i++,MO:i++,VO:i++,CO:i++,uO:i++,TO:i++,PO:i++,LO:i++,GO:i++,lO:i++,fO:i++,pO:i++,DO:i++,UO:i++,dO:i++,vO:i++,bO:i++,HO:i++,kO:i++,mO:i++,gO:i++,wO:i++,yO:i++,hO:i++,xO:i++,YO:i++,FO:i++}}if(void 0===AG_LIVEVDNMOONSERVER){i=0;var AG_LIVEVDNMOONSERVER={KO:i++,WO:i++,BO:i++,qO:i++,JO:i++,QO:i++,jO:i++,XO:i++,zO:i++,ZO:i++,$O:i++,ea:i++,Ra:i++,ta:i++,Oa:i++,aa:i++,Ea:i++,_a:i++,na:i++,sa:i++,ra:i++,ca:i++,Sa:i++,ia:i++}}function clone(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date)return(R=new Date).setTime(e.getTime()),R;if(e instanceof Array){for(var R=[],t=e.length,O=0;O<t;++O)R[O]=clone(e[O]);return R}if(e instanceof Object){R={};for(var a in e)e.hasOwnProperty(a)&&(R[a]=clone(e[a]));return R}throw new Error("Unable to copy obj! Its type isn't supported.")}StarRtc.AUtils=new function(){var e=this;function L(e,R){for(var t=q(e),O=J(w(t.length.toString(16))),a=q(R),E=J(w(a.length.toString(16))),_=new Uint8Array(t.length+a.length+8),n=0,s=O.length,r=n;r<s;r++)_[r]=O[r-n];s=(n=s)+t.length;for(r=n;r<s;r++)_[r]=t[r-n];s=(n=s)+E.length;for(r=n;r<s;r++)_[r]=E[r-n];s=(n=s)+a.length;for(r=n;r<s;r++)_[r]=a[r-n];return _}function b(e){var R=new Uint8Array(e),t=0,O=parseInt("0x"+k(R.slice(t,t+4)));t+=4;var a=H(R.slice(t,t+O));t+=O;var E=parseInt("0x"+k(R.slice(t,t+4)));return t+=4,{digest:a,content:H(R.slice(t,t+E))}}function w(e){var R=8-e.length;return"00000000".substr(0,R)+e}function W(e){var R=4-e.length;return"0000".substr(0,R)+e}function B(e,R){var t=new Array(e+1).join("0"),O=e-R.length;return t.substr(0,O)+R}function q(e){var R,t,O=new Array;R=e.length;for(var a=0;a<R;a++)65536<=(t=e.charCodeAt(a))&&t<=1114111?(O.push(t>>18&7|240),O.push(t>>12&63|128),O.push(t>>6&63|128),O.push(63&t|128)):2048<=t&&t<=65535?(O.push(t>>12&15|224),O.push(t>>6&63|128),O.push(63&t|128)):128<=t&&t<=2047?(O.push(t>>6&31|192),O.push(63&t|128)):O.push(255&t);return O}function H(e){if("string"==typeof e)return e;for(var R="",t=e,O=0;O<t.length;O++){var a=t[O].toString(2),E=a.match(/^1+?(?=0)/);if(E&&8==a.length){for(var _=E[0].length,n=t[O].toString(2).slice(7-_),s=1;s<_;s++)n+=t[s+O].toString(2).slice(2);R+=String.fromCharCode(parseInt(n,2)),O+=_-1}else R+=String.fromCharCode(t[O])}return R}function J(e){var R=0,t=e.length;if(t%2!=0)return null;t/=2;for(var O=new Array,a=0;a<t;a++){var E=e.substr(R,2),_=parseInt("0x"+E);O.push(_),R+=2}return O}function k(e){for(var R="",t=0;t<e.length;t++){var O=e[t].toString(16);1==O.length&&(O="0"+O),R+=O}return R}function Q(e,R,t){var O=R;for(var a in t)for(var E=t[a],_=0;_<E.length;_++,O++)e[O]=E[_]}e.parseProtocol=function(e,c){var R=new Blob([e],{type:"text/plain"}),S=new FileReader;S.readAsArrayBuffer(R),S.onload=function(e){var R=new Uint8Array(S.result);console.info("parseProtocol:",R);var t=R[0],O=R.slice(1,5),a=R[5],E=R.slice(6,8),_=R.slice(8,10),n=R[10],s=R.slice(11,R.byteLength-2);console.info("parseProtocol: msgArr = ",s);var r=R.slice(R.byteLength-2,R.byteLength);c({appid:t,plength:O,appver:a,rese1:E,rese2:_,actionid:n,msgArr:s,end:r})}},e.packageProtocol=function(e,R,t){var O=e,a=new Array(255,255),E=new Array(255,255),_=R,n=(new Array(18,52),t),s=new Uint8Array(n),r=J(w((n.byteLength+12).toString(16))),c=new ArrayBuffer(n.byteLength+13),S=new Uint8Array(c);S[0]=O;for(var i=1;i<5;i++)S[i]=r[i-1];S[5]=1,S[6]=a[0],S[7]=a[1],S[8]=E[0],S[9]=E[1],S[10]=_;for(i=11;i<11+s.byteLength;i++)S[i]=s[i-11];return S[11+s.byteLength]=18,S[12+s.byteLength]=52,console.log("packageProtocol",S),S},e.constructAuthMsg=function(e){e.agentId,e.userId;for(var R=e.starUid,t=e.starToken,O=J(W(AG_MSG.q.toString(16))),a=q(R),E=J(W(a.length.toString(16))),_=q(t),n=new Uint8Array(a.length+36),s=0,r=O.length,c=s;c<r;c++)n[c]=O[c];r=(s=r)+E.length;for(c=s;c<r;c++)n[c]=E[c-s];r=(s=r)+a.length;for(c=s;c<r;c++)n[c]=a[c-s];r=(s=r)+_.length;for(c=s;c<r;c++)n[c]=_[c-s];s=0;var S=[];return S.push(O),S.push(E),S.push(a),S.push(_),Q(n,s,S),n},e.constructMsgProtocol=function(e,R,t){t.agentId,t.userId;var O,a=t.starUid,E=t.starToken,_=[],n=J(W(e.toString(16))),s=q(a),r=J(W(s.length.toString(16)));J(W(q(E).length.toString(16)));switch(e){case AG_MSG.ee:var c=J(w(R.reqIndex.toString(16))),S=J(w((o=q(R.addUsers)).length.toString(16))),i=J(w((A=q(R.userDefineData)).length.toString(16)));O=new Uint8Array(6+(2+s.length)+(4+o.length)+(4+A.length)),_.push(n),_.push(c),_.push(r),_.push(s),_.push(S),_.push(o),_.push(i),_.push(A);break;case AG_MSG.Re:c=J(w(R.reqIndex.toString(16)));var I=J(w((V=q(R.groupId)).length.toString(16)));O=new Uint8Array(6+(2+V.length)+(2+s.length)),_.push(n),_.push(c),_.push(I),_.push(V),_.push(r),_.push(s);break;case AG_MSG.te:var o;c=J(w(R.reqIndex.toString(16))),I=J(w((V=q(R.groupId)).length.toString(16))),S=J(w((o=q(R.addUsers)).length.toString(16))),i=J(w((A=q(R.userDefineData)).length.toString(16)));O=new Uint8Array(6+(2+V.length)+(2+s.length)+(4+o.length)+(4+A.length)),_.push(n),_.push(c),_.push(I),_.push(V),_.push(r),_.push(s),_.push(S),_.push(o),_.push(i),_.push(A);break;case AG_MSG.Oe:c=J(w(R.reqIndex.toString(16))),I=J(w((V=q(R.groupId)).length.toString(16)));var A,N=q(R.removeUsers),M=J(w(N.length.toString(16)));i=J(w((A=q(R.userDefineData)).length.toString(16)));O=new Uint8Array(6+(2+V.length)+(2+s.length)+(4+N.length)),_.push(n),_.push(c),_.push(I),_.push(V),_.push(r),_.push(s),_.push(M),_.push(N);break;case AG_MSG.ae:case AG_MSG.Ee:c=J(w(R.reqIndex.toString(16))),I=J(w((V=q(R.groupId)).length.toString(16)));O=new Uint8Array(6+(2+V.length)+(2+s.length)),_.push(n),_.push(c),_.push(I),_.push(V),_.push(r),_.push(s);break;case AG_MSG._e:case AG_MSG.ne:break;case AG_MSG.de:c=J(w(R.reqIndex.toString(16)));O=new Uint8Array(6+(2+s.length)),_.push(n),_.push(c),_.push(r),_.push(s);break;case AG_MSG.be:var V;c=J(w(R.reqIndex.toString(16))),I=J(W((V=q(R.groupId)).length.toString(16)));O=new Uint8Array(6+(2+s.length)+(2+V.length)),_.push(n),_.push(c),_.push(r),_.push(s),_.push(I),_.push(V);break;case AG_MSG.ke:O=new Uint8Array(2),_.push(n);break;case AG_MSG.ge:O=new Uint8Array(4);var C=J(W(R.reqPageNum.toString(16)));_.push(n),_.push(C)}return Q(O,0,_),O},e.constructSingleMsg=function(e,R,t,O,a,E){var _=E.agentId,n=E.userId,s=E.starUid,r=(E.starToken,J(W(AG_MSG.$.toString(16)))),c=q(s),S=J(W(c.length.toString(16))),i=q(_+"_"+e),I=J(W(i.length.toString(16))),o=J(w(R.toString(16))),A=ENCRYPT_TYPE.m,N=MSG_DATA_TYPE.v;null!=a&&(N=a);var M={fromId:n,targetId:e,time:"0",msgIndex:R,type:1,code:0,contentData:O},V=L(t,JSON.stringify(M)),C=J(w(V.length.toString(16))),u=new Uint8Array(c.length+i.length+V.length+16),T=[];return T.push(r),T.push(S),T.push(c),T.push(I),T.push(i),T.push(o),T.push([A]),T.push([N]),T.push(C),T.push(V),Q(u,0,T),u},e.constructGroupMsg=function(e,R,t,O,a){var E=a.agentId,_=a.userId,n=a.starUid,s=(a.starToken,J(W(AG_MSG.se.toString(16)))),r=q(""),c=J(W(r.length.toString(16))),S=J(w(R.toString(16))),i=q(E+"_"+e),I=J(W(i.length.toString(16))),o=q(n),A=J(W(o.length.toString(16))),N=ENCRYPT_TYPE.m,M=MSG_DATA_TYPE.v,V={fromId:_,targetId:e,time:"0",msgIndex:R,type:1,code:0,contentData:O},C=L(t,JSON.stringify(V)),u=J(w(C.length.toString(16))),T=new Uint8Array(r.length+i.length+o.length+C.length+18),P=[];return P.push(s),P.push(c),P.push(r),P.push(S),P.push(I),P.push(i),P.push(A),P.push(o),P.push([N]),P.push([M]),P.push(u),P.push(C),Q(T,0,P),T},e.constructReceivedMsg=function(e,R){R.agentId,R.userId;var t=R.starUid,O=(R.starToken,J(W(AG_MSG.ue.toString(16)))),a=q(t),E=J(W(a.length.toString(16))),_=new Uint8Array(e),n=new Uint8Array(a.length+12),s=[];return s.push(O),s.push(E),s.push(a),s.push(_),Q(n,0,s),n},e.constructSingleCtrlMsg=function(e,R,t,O,a,E){var _=E.agentId,n=E.userId,s=E.starUid,r=(E.starToken,J(W(AG_MSG.$.toString(16)))),c=q(s),S=J(W(c.length.toString(16))),i=q(_+"_"+e),I=J(W(i.length.toString(16))),o=J(w(R.toString(16))),A=ENCRYPT_TYPE.m,N=MSG_DATA_TYPE.U,M={fromId:n,targetId:e,time:"0",msgIndex:R,type:0,code:parseInt(a),contentData:O},V=L(t,JSON.stringify(M)),C=J(w(V.length.toString(16))),u=new Uint8Array(c.length+i.length+V.length+16),T=[];return T.push(r),T.push(S),T.push(c),T.push(I),T.push(i),T.push(o),T.push([A]),T.push([N]),T.push(C),T.push(V),Q(u,0,T),u},e.constructVOIPProtocol=function(e,R,t){var O,a=t.agentId,E=(t.userId,t.starUid),_=t.starToken,n=[],s=J(W(e.toString(16))),r=q(E),c=J(W(r.length.toString(16))),S=q(_),i=J(W(S.length.toString(16)));switch(e){case AG_VOIPMOONSERVER.mR:case AG_VOIPMOONSERVER.wR:var I=q(a+"_"+R.targetId),o=J(W(I.length.toString(16))),A=J(B(8,parseInt(R.audioSSRC).toString(16))),N=J(B(8,parseInt(R.videoSSRC).toString(16))),M=J(B(2,parseInt(R.videoCodec).toString(16))),V=J(B(2,parseInt(R.audioCodec).toString(16)));O=new Uint8Array(2+(2+r.length)+(2+S.length)+(2+I.length)+4+4+1+1),n.push(s),n.push(c),n.push(r),n.push(i),n.push(S),n.push(o),n.push(I),n.push(A),n.push(N),n.push(M),n.push(V);break;case AG_VOIPMOONSERVER.xR:var C=R.isActive;O=new Uint8Array(3),n.push(s),n.push([C])}return Q(O,0,n),O},e.constructSrcProtocol=function(e,R,t){t.agentId;var O=t.userId,a=t.starUid,E=t.starToken,_=[],n=J(W(e.toString(16))),s=J(W((M=q(a)).length.toString(16))),r=J(W((v=q(E)).length.toString(16)));switch(e){case AG_LIVESRCMOONSERVER.FO:case AG_LIVESRCMOONSERVER.kt:case AG_LIVESRCMOONSERVER.gt:var c=J(W(R.conCurrentNum.toString(16))),S=J(W((0).toString(16))),i=J(W((A=q(R.roomId)).length.toString(16))),I=R.liveType,o=J(W((u=q(R.extra)).length.toString(16)));Y=new Uint8Array(2+(2+M.length)+(2+v.length)+2+2+(2+A.length)+1+(2+u.length)),_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(c),_.push(S),_.push(i),_.push(A),_.push([I]),_.push(o),_.push(u);break;case AG_LIVESRCMOONSERVER.wt:c=J(W(R.conCurrentNum.toString(16))),S=J(W(R.validTime.toString(16))),i=J(W((A=q(R.roomId)).length.toString(16))),o=J(W((u=q(R.extra)).length.toString(16)));var A,N=J(W((T=q(R.spec)).length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(c),_.push(S),_.push(i),_.push(A),_.push(o),_.push(u),_.push(N),_.push(T);break;case AG_LIVESRCMOONSERVER.yt:s=J(W((M=q(O)).length.toString(16))),r=J(W((v=q(E)).length.toString(16))),S=J(W((0).toString(16)));var M,V=J(W((C=q(R.groupId)).length.toString(16)));o=J(W((u=q(R.extra)).length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(S),_.push(V),_.push(C),_.push(o),_.push(u);break;case AG_LIVESRCMOONSERVER.ht:var C,u,T;S=J(W((0).toString(16))),V=J(W((C=q(R.groupId)).length.toString(16))),o=J(W((u=q(R.extra)).length.toString(16))),N=J(W((T=q(R.spec)).length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(S),_.push(V),_.push(C),_.push(o),_.push(u),_.push(N),_.push(T);break;case AG_LIVESRCMOONSERVER.xt:var P=q(R.channelId),L=q(R.avParam),G=J(W(L.length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(P),_.push(G),_.push(L);break;case AG_LIVESRCMOONSERVER.Ft:P=q(R.channelId);var l=J(W((f=q(R.upUserId)).length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(P),_.push(l),_.push(f);break;case AG_LIVESRCMOONSERVER.Kt:case AG_LIVESRCMOONSERVER.Wt:case AG_LIVESRCMOONSERVER.Bt:var f;P=q(R.channelId),l=J(W((f=q(R.upUserId)).length.toString(16)));_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(P),_.push(l),_.push(f);break;case AG_LIVESRCMOONSERVER.qt:case AG_LIVESRCMOONSERVER.Jt:P=q(R.channelId);Y=new Uint8Array(2+(2+M.length)+(2+v.length)+16),_.push(n),_.push(s),_.push(M),_.push(r),_.push(v),_.push(P);break;case AG_LIVESRCMOONSERVER.Qt:for(var p=R.streamConfig,D=new Uint8Array(16),U=0;U<16;U++)null!=p[U]?D[U]=p[U]:D[U]=0;Y=new Uint8Array(18),_.push(n),_.push(D);break;case AG_LIVESRCMOONSERVER.jt:P=q(R.channelId);_.push(n),_.push(P);break;case AG_LIVESRCMOONSERVER.zt:_.push(n);break;case AG_LIVESRCMOONSERVER.Xt:var d=q(R.streamData);Y=new Uint8Array(3+d.length),_.push(n),_.push([R.streamDataType]),_.push(d);break;case AG_LIVESRCMOONSERVER.Yt:var v,b=q(a),H=J(W(b.length.toString(16))),k=(r=J(W((v=q(E)).length.toString(16))),P=q(R.channelId),J(B(8,parseInt(R.audioSSRC).toString(16)))),m=J(B(8,parseInt(R.smallVideoSSRC).toString(16))),g=J(B(8,parseInt(R.bigVideoSSRC).toString(16))),w=J(B(2,parseInt(R.videoCodec).toString(16))),y=J(B(2,parseInt(R.audioCodec).toString(16))),h=J(W((F=q(R.iceUfrag)).length.toString(16))),x=J(W((K=q(R.icePwd)).length.toString(16))),Y=new Uint8Array(b.length+v.length+34+1+1+2+F.length+2+K.length);_.push(n),_.push(H),_.push(b),_.push(r),_.push(v),_.push(P),_.push(k),_.push(m),_.push(g),_.push(w),_.push(y),_.push(F),_.push(K);break;case AG_LIVESRCMOONSERVER.hO:var F,K;h=J(W((F=q(R.iceUfrag)).length.toString(16))),x=J(W((K=q(R.icePwd)).length.toString(16)));Y=new Uint8Array(4+F.length+2+K.length),_.push(n),_.push(h),_.push(F),_.push(x),_.push(K)}return Q(Y,0,_),Y},e.constructVdnProtocol=function(e,R,t){t.agentId,t.userId;var O,a=t.starUid,E=t.starToken,_=[],n=J(W(e.toString(16))),s=q(a),r=J(W(s.length.toString(16))),c=q(E),S=J(W(c.length.toString(16)));switch(e){case AG_LIVEVDNMOONSERVER.BO:var i=q(R.iceUfrag),I=J(W(i.length.toString(16))),o=q(R.icePwd),A=J(W(o.length.toString(16)));O=new Uint8Array(4+i.length+2+o.length),_.push(n),_.push(I),_.push(i),_.push(A),_.push(o);break;case AG_LIVEVDNMOONSERVER.qO:var N=q(R.channelId);O=new Uint8Array(18+(2+s.length)+(2+c.length)),_.push(n),_.push(N),_.push(r),_.push(s),_.push(S),_.push(c);break;case AG_LIVEVDNMOONSERVER.JO:case AG_LIVEVDNMOONSERVER.QO:O=new Uint8Array(2),_.push(n);break;case AG_LIVEVDNMOONSERVER.zO:case AG_LIVEVDNMOONSERVER.jO:N=q(R.channelId);O=new Uint8Array(18),_.push(n),_.push(N);break;case AG_LIVEVDNMOONSERVER.XO:for(var M=R.streamConfig,V=new Uint8Array(16),C=0;C<16;C++)null!=M[C]?V[C]=M[C]:V[C]=0;O=new Uint8Array(18),_.push(n),_.push(V)}return Q(O,0,_),O},e.constructChatProtocol=function(e,R,t){var O,a=t.agentId,E=t.userId,_=t.starUid,n=t.starToken,s=[],r=J(W(e.toString(16))),c=q(_),S=J(W(c.length.toString(16))),i=q(n),I=J(W(i.length.toString(16)));if(e==AG_CHATROOMMOONSERVER.Ye){var o=R.roomType,A=J(W(R.conCurrentNum.toString(16))),N=J(w((d=q(R.userDefineData)).length.toString(16)));O=new Uint8Array(2+(2+c.length)+(2+i.length)+1+2+(4+d.length)),s.push(r),s.push(S),s.push(c),s.push(I),s.push(i),s.push([o]),s.push(A),s.push(N),s.push(d)}else if(e==AG_CHATROOMMOONSERVER.Fe)O=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.Ke){var M=q(a+"_"+R.banUserId),V=J(W(M.length.toString(16))),C=J(W(R.banTime.toString(16)));O=new Uint8Array(2+(2+M.length)+2),s.push(r),s.push(V),s.push(M),s.push(C)}else if(e==AG_CHATROOMMOONSERVER.We){var u=q(a+"_"+R.kickOutUserId),T=J(W(u.length.toString(16)));O=new Uint8Array(2+(2+u.length)),s.push(r),s.push(T),s.push(u)}else if(e==AG_CHATROOMMOONSERVER.Be)O=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.qe){var P=q(R.roomId);O=new Uint8Array(2+(2+c.length)+(2+i.length)+16),s.push(r),s.push(S),s.push(c),s.push(I),s.push(i),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.Je);else if(e==AG_CHATROOMMOONSERVER.Qe)O=new Uint8Array(2),s.push(r);else if(e==AG_CHATROOMMOONSERVER.je){var L={fromId:E,targetId:R.roomId,time:"0",msgIndex:R.msgIndex,type:1,code:0,contentData:R.msg},G=q(JSON.stringify(L)),l=J(w(G.length.toString(16)));O=new Uint8Array(2+(4+G.length)),s.push(r),s.push(l),s.push(G)}else if(e==AG_CHATROOMMOONSERVER.Xe){L={fromId:E,targetId:R.roomId,time:"0",msgIndex:R.msgIndex,type:parseInt(R.type),code:parseInt(R.code),contentData:R.msg};var f=q(JSON.stringify(L)),p=J(w(f.length.toString(16))),D=q(a+"_"+R.toUserId),U=J(W(D.length.toString(16)));O=new Uint8Array(2+(2+D.length)+(4+f.length)),s.push(r),s.push(U),s.push(D),s.push(p),s.push(f)}else if(e==AG_CHATROOMMOONSERVER.ze){P=q(R.roomId);O=new Uint8Array(18),s.push(r),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.GR){var d,v=J(W((H=q(E)).length.toString(16))),b=J(W(R.listType.toString(16)));N=J(w((d=q(R.userDefineData)).length.toString(16))),P=q(R.roomId);O=new Uint8Array(4+(2+H.length)+16+(4+d.length)),s.push(r),s.push(b),s.push(v),s.push(H),s.push(P),s.push(N),s.push(d)}else if(e==AG_CHATROOMMOONSERVER.pR){b=J(W(R.listType.toString(16))),P=q(R.roomId),v=J(W((H=q(E)).length.toString(16)));O=new Uint8Array(4+(2+H.length)+16),s.push(r),s.push(b),s.push(v),s.push(H),s.push(P)}else if(e==AG_CHATROOMMOONSERVER.dR){var H,k=q(R.listTypes),m=J(W(k.length.toString(16))),g=J(W((H=q(R.userId)).length.toString(16)));O=new Uint8Array(2+(2+k.length)+(2+H.length)),s.push(r),s.push(m),s.push(k),s.push(g),s.push(H)}return Q(O,0,s),O},e.parseMessage=function(e,R){var t=new Uint8Array(e);switch(parseInt("0x"+k(t.slice(0,2)))){case AG_MSG.J:t=new Uint8Array(e);var O=parseInt("0x"+k(t.slice(2,4)));console.log("登录成功，最大消息长度：",O),R({status:"success",msgMaxLen:O},"onLoginMessage");break;case AG_MSG.j:console.log("登录失败"),R({status:"failed"},"onLoginMessage");break;case AG_MSG.Z:console.log("心跳反馈");break;case AG_MSG.Ve:console.log("服务器收到消息");break;case AG_MSG.Ce:console.log("收到消息");parseInt("0x"+k(t.slice(10,14)));var a=15;switch(t[14]){case MSG_TYPE.L:console.log("单聊消息");var E=parseInt("0x"+k(t.slice(a,a+2)));a+=2;var _=H(t.slice(a,a+E)),n=t[a+=E];switch(a+=1,n){case ENCRYPT_TYPE.m:var s=parseInt("0x"+k(t.slice(a,a+4)));a+=4;var r=b(t.slice(a,a+s));console.log(_,r.digest,r.content),2==(i=_.split("_")).length&&(_=i[1]),R(e={fromId:_,digest:r.digest,msg:r.content,msgNode:t.slice(2,10)},"onSingleMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.G:console.log("群消息");var c=parseInt("0x"+k(t.slice(a,a+2)));a+=2;var S=H(t.slice(a,a+c));a+=c;E=parseInt("0x"+k(t.slice(a,a+2)));a+=2;_=H(t.slice(a,a+E)),n=t[a+=E];switch(a+=1,n){case ENCRYPT_TYPE.m:s=parseInt("0x"+k(t.slice(a,a+4)));a+=4;r=b(t.slice(a,a+s));console.log(S,_,r.digest,r.content),2==(i=_.split("_")).length&&(_=i[1]),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,fromId:_,digest:r.digest,msg:r.content,msgNode:t.slice(2,10)},"onGroupMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.l:console.log("群私信消息");c=parseInt("0x"+k(t.slice(a,a+2)));a+=2;S=H(t.slice(a,a+c));a+=c;E=parseInt("0x"+k(t.slice(a,a+2)));a+=2;_=H(t.slice(a,a+E)),n=t[a+=E];switch(a+=1,n){case ENCRYPT_TYPE.m:s=parseInt("0x"+k(t.slice(a,a+4)));a+=4;var i;r=b(t.slice(a,a+s));console.log(S,_,r.digest,r.content),2==(i=_.split("_")).length&&(_=i[1]),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,fromId:_,digest:r.digest,msg:r.content,msgNode:t.slice(2,10)},"onGroupPrivateMessage");break;case ENCRYPT_TYPE.g:}break;case MSG_TYPE.p:console.log("推送群信息");c=parseInt("0x"+k(t.slice(a,a+2)));a+=2;S=H(t.slice(a,a+c));a+=c;s=parseInt("0x"+k(t.slice(a,a+4)));a+=4;var I;r=b(t.slice(a,a+s));console.log(S,r.digest,r.content),2==(I=S.split("_")).length&&(S=I[1]),R(e={groupId:S,digest:r.digest,msg:r.content,msgNode:t.slice(2,10)},"onGroupPushMessage");break;case MSG_TYPE.D:console.log("推送系统信息");s=parseInt("0x"+k(t.slice(a,a+4)));a+=4;r=b(t.slice(a,a+s));console.log(r.digest,r.content),R(e={digest:r.digest,msg:r.content,msgNode:t.slice(2,10)},"onSystemPushMessage")}break;case AG_MSG.Te:var o=parseInt("0x"+k(t.slice(2,4))),A=H(t.slice(6,t.byteLength));console.log("报错:",o,A),R(e={errId:o,errStr:A},"onErrorMessage");break;case AG_MSG.re:var N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),V=parseInt("0x"+k(t.slice(4+N,4+N+4)));c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,groupMsgIndex:V,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c)),serverTimestamp:parseInt("0x"+k(t.slice(4+N+4+2+c,4+N+4+2+c+4)))},"onSendGroupMsgFin");break;case AG_MSG.ce:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N));var C=parseInt("0x"+k(t.slice(4+N,4+N+4)));c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onCreateGroupFin");break;case AG_MSG.Se:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onDelGroupFin");break;case AG_MSG.ie:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onAddGroupUserFin");break;case AG_MSG.Ie:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onRemoveGroupUserFin");break;case AG_MSG.oe:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onSetGroupMsgIgnoreFin");break;case AG_MSG.Ae:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onUnsetGroupMsgIgnoreFin");break;case AG_MSG.Ne:N=parseInt("0x"+k(t.slice(2,4)));R({status:"success",statusStr:M=H(t.slice(4,4+N)),reqIndex:C=parseInt("0x"+k(t.slice(4+N,4+N+4)))},"onPushSystemMsgFin");break;case AG_MSG.Me:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4))),c=parseInt("0x"+k(t.slice(4+N+4,4+N+4+2)));R({status:"success",statusStr:M,reqIndex:C,groupId:S=H(t.slice(4+N+4+2,4+N+4+2+c))},"onPushGroupSystemMsgFin");break;case AG_MSG.ve:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4)));var u=parseInt("0x"+k(t.slice(4+N+4,4+N+4+4))),T=H(t.slice(4+N+4+4,4+N+4+4+u)).split(",");0==u&&(T=[]);for(var P=parseInt("0x"+k(t.slice(4+N+4+4+u,4+N+4+4+u+4))),L=H(t.slice(4+N+4+4+u+4,4+N+4+4+u+4+P)).split(","),G=parseInt("0x"+k(t.slice(4+N+4+4+u+4+P,4+N+4+4+u+4+P+4))),l=H(t.slice(4+N+4+4+u+4+P+4,4+N+4+4+u+4+P+4+G)).split(","),f=[],p=0;p<T.length;p++){var D={id:T[p],name:L[p],creator:l[p]};f.push(D)}R({status:"success",statusStr:M,reqIndex:C,groupsInfo:f},"onGetGroupList");break;case AG_MSG.He:N=parseInt("0x"+k(t.slice(2,4))),M=H(t.slice(4,4+N)),C=parseInt("0x"+k(t.slice(4+N,4+N+4)));var U=parseInt("0x"+k(t.slice(4+N+4,4+N+4+4)));R({status:"success",statusStr:M,reqIndex:C,userIdList:H(t.slice(4+N+4+4,4+N+4+4+U)).split(",")},"onGetGroupUserList");break;case AG_MSG.me:R({status:"success",count:parseInt("0x"+k(t.slice(2,6))),totalPageNum:d=parseInt("0x"+k(t.slice(6,8)))},"onGetOnlineNumber");break;case AG_MSG.we:var d=parseInt("0x"+k(t.slice(2,4))),v=parseInt("0x"+k(t.slice(4,6)));U=parseInt("0x"+k(t.slice(6,10)));R({status:"success",totalPageNum:d,reqPageNum:v,userIdList:H(t.slice(10,10+U)).split(",")},"onGetAllUserList");break;case AG_MSG.ye:R({status:"failed",totalPageNum:d=parseInt("0x"+k(t.slice(2,4))),reqPageNum:v=parseInt("0x"+k(t.slice(4,6)))},"onGetAllUserList")}},e.parseSrcMoonServerMessage=function(e,R){var t=new Uint8Array(e);switch(parseInt("0x"+k(t.slice(0,2)))){case AG_LIVESRCMOONSERVER.RO:k(t.slice(18,20));var O=parseInt("0x"+k(t.slice(18,20)));R({type:"srcApplyUpload",status:"success",fingerprint:H(t.slice(20,20+O))});break;case AG_LIVESRCMOONSERVER.tO:var a=parseInt("0x"+k(t.slice(2,4)));R({type:"srcApplyUpload",status:"failed",msg:i=H(t.slice(4,4+a))});break;case AG_LIVESRCMOONSERVER.PO:console.log("webrtc心跳反馈");break;case AG_LIVESRCMOONSERVER.LO:for(var E=parseInt("0x"+k(t.slice(2,3))),_=3,n=t.length,s={siv:E,uperInfos:{}};_<n;){var r=parseInt("0x"+k(t.slice(_,_+1)));_+=1;var c=parseInt("0x"+k(t.slice(_,_+2)));_+=2;var S=H(t.slice(_,_+c));_+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"uperStreamInfoUpdate",status:"success",msg:s});break;case AG_LIVESRCMOONSERVER.TO:R({type:"stopStream",status:"success"});break;case AG_LIVESRCMOONSERVER.NO:R({type:"streamConfig",status:"success",channelId:H(t.slice(2,18))});break;case AG_LIVESRCMOONSERVER.MO:R({type:"streamConfig",status:"failed",channelId:H(t.slice(2,18))});break;case AG_LIVESRCMOONSERVER.oO:R({type:"delChannel",status:"success",channelId:H(t.slice(2,18))});break;case AG_LIVESRCMOONSERVER.AO:a=parseInt("0x"+k(t.slice(2,4)));var i=H(t.slice(4,4+a));R({type:"delChannel",status:"failed",channelId:H(t.slice(4+a,4+a+16)),msg:i});break;case AG_LIVESRCMOONSERVER.Zt:R({type:"createChannel",status:"success",channelId:H(t.slice(2,18))});break;case AG_LIVESRCMOONSERVER.$t:a=parseInt("0x"+k(t.slice(2,4)));R({type:"createChannel",status:"failed",msg:i=H(t.slice(4,4+a))});break;case AG_LIVESRCMOONSERVER.GO:r=parseInt("0x"+k(t.slice(2,3))),E=parseInt("0x"+k(t.slice(3,4)));var I=H(t.slice(5));R({type:"streamData",status:"success",upId:r,siv:E,streamDataType:parseInt("0x"+k(t.slice(4,5))),streamData:I});break;case AG_LIVESRCMOONSERVER.lO:(i={}).errId=parseInt("0x"+k(t.slice(2,4))),i.errStrlen=parseInt("0x"+k(t.slice(4,6))),i.errStr=H(t.slice(6,6+i.errStrlen)),R({type:"serverErr",status:"failed",msg:i});break;case AG_LIVESRCMOONSERVER.xO:O=parseInt("0x"+k(t.slice(2,4)));R({type:"webrtcReg",status:"success",fingerprint:H(t.slice(4,4+O))});break;case AG_LIVESRCMOONSERVER.YO:R({type:"webrtcConnect",status:"success"})}},e.parseVdnMoonServerMessage=function(e,R){var t=new Uint8Array(e);switch(parseInt("0x"+k(t.slice(0,2)))){case AG_LIVEVDNMOONSERVER.ZO:var O=parseInt("0x"+k(t.slice(2,4)));R({type:"webrtcReg",status:"success",fingerprint:H(t.slice(4,4+O))});break;case AG_LIVEVDNMOONSERVER.$O:for(var a=H(t.slice(2,18)),E=parseInt("0x"+k(t.slice(18,19))),_=19,n=t.length,s={siv:E,uperInfos:{}};_<n;){var r=parseInt("0x"+k(t.slice(_,_+1)));_+=1;var c=parseInt("0x"+k(t.slice(_,_+2)));_+=2;var S=H(t.slice(_,_+c));_+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"vdnApplyDownload",status:"success",channelId:a,uperInfos:s});break;case AG_LIVEVDNMOONSERVER.ea:console.log("vdn 心跳反馈");break;case AG_LIVEVDNMOONSERVER.Ra:var i=parseInt("0x"+k(t.slice(2,4))),I=H(t.slice(4,4+i));R({type:"vdnApplyDownload",status:"failed",channelId:a=H(t.slice(4+i,4+i+16)),failedStatus:I});break;case AG_LIVEVDNMOONSERVER.ta:R({type:"streamConfig",status:"success",channelId:a=H(t.slice(2,18))});break;case AG_LIVEVDNMOONSERVER.Oa:R({type:"streamConfig",status:"failed",channelId:a=H(t.slice(2,18))});break;case AG_LIVEVDNMOONSERVER.aa:for(a=H(t.slice(2,18)),E=parseInt("0x"+k(t.slice(18,19))),_=19,n=t.length,s={channelId:a,siv:E,uperInfos:{}};_<n;){r=parseInt("0x"+k(t.slice(_,_+1)));_+=1;c=parseInt("0x"+k(t.slice(_,_+2)));_+=2;S=H(t.slice(_,_+c));_+=c,s.uperInfos[r]={upId:r,userId:S}}R({type:"uperStreamInfoUpdate",status:"success",channelId:a,msg:s});break;case AG_LIVEVDNMOONSERVER.Ea:R({type:"streamData",status:"success",upId:r=parseInt("0x"+k(t.slice(2,3))),siv:E=parseInt("0x"+k(t.slice(3,4))),streamDataType:parseInt("0x"+k(t.slice(4,5))),streamData:H(t.slice(5))});break;case AG_LIVEVDNMOONSERVER._a:break;case AG_LIVEVDNMOONSERVER.ia:R({type:"webrtcConnect",status:"success"});break;case AG_LIVEVDNMOONSERVER.na:case AG_LIVEVDNMOONSERVER.sa:break;case AG_LIVEVDNMOONSERVER.ca:var o={};o.errId=parseInt("0x"+k(t.slice(2,4))),o.errStrlen=parseInt("0x"+k(t.slice(4,6))),o.errStr=H(t.slice(6,6+o.errStrlen)),R({type:"serverErr",status:"failed",msg:o})}},e.parseChatMoonServerMessage=function(e,R){var t=new Uint8Array(e),O=parseInt("0x"+k(t.slice(0,2)));switch(O){case AG_CHATROOMMOONSERVER.Ze:R({type:"createChatRoom",status:"success",chatroomId:E=H(t.slice(2,18)),maxContentLen:parseInt("0x"+k(t.slice(18,20)))});break;case AG_CHATROOMMOONSERVER.$e:var a=parseInt("0x"+k(t.slice(2,4)));R({type:"createChatRoom",status:"failed",status:H(t.slice(4,4+a))});break;case AG_CHATROOMMOONSERVER.eR:R({type:"deleteChatRoom",status:"success",roomId:E=H(t.slice(2,18))});break;case AG_CHATROOMMOONSERVER.RR:var E=H(t.slice(2,18));a=parseInt("0x"+k(t.slice(18,20)));R({type:"deleteChatRoom",status:"failed",msg:H(t.slice(20,20+a)),roomId:E});break;case AG_CHATROOMMOONSERVER.tR:var _=parseInt("0x"+k(t.slice(2,4)));R({type:"banaedToSendMsg",status:"success",banUserId:n=H(t.slice(4,4+_)),banTime:s=parseInt("0x"+k(t.slice(4+_,4+_+2)))});break;case AG_CHATROOMMOONSERVER.OR:_=parseInt("0x"+k(t.slice(2,4)));var n=H(t.slice(4,4+_)),s=parseInt("0x"+k(t.slice(4+_,4+_+2)));a=parseInt("0x"+k(t.slice(4+_+2,4+_+2+2)));R({type:"banaedToSendMsg",status:"failed",banUserId:n,banTime:s,msg:H(t.slice(4+_+2+2,4+_+2+2+a))});break;case AG_CHATROOMMOONSERVER.aR:var r=parseInt("0x"+k(t.slice(2,4)));R({type:"kickOutUser",status:"success",kickOutUserId:c=H(t.slice(4,4+r))});break;case AG_CHATROOMMOONSERVER.ER:r=parseInt("0x"+k(t.slice(2,4)));var c=H(t.slice(4,4+r));a=parseInt("0x"+k(t.slice(4+r,4+_+2)));R({type:"kickOutUser",status:"failed",kickOutUserId:c,msg:H(t.slice(4+r+2,4+r+2+a))});break;case AG_CHATROOMMOONSERVER._R:case AG_CHATROOMMOONSERVER.nR:R({type:"joinChatRoom",status:"success",roomId:E=H(t.slice(2,18)),maxContentLen:parseInt("0x"+k(t.slice(18,20)))});break;case AG_CHATROOMMOONSERVER.sR:E=H(t.slice(2,18)),a=parseInt("0x"+k(t.slice(18,20)));R({type:"joinChatRoom",status:"failed",failedStatus:H(t.slice(20,20+a)),roomId:E});break;case AG_CHATROOMMOONSERVER.rR:console.log("chatRoom心跳反馈");break;case AG_CHATROOMMOONSERVER.cR:case AG_CHATROOMMOONSERVER.SR:var S=parseInt("0x"+k(t.slice(2,4))),i=H(t.slice(4,4+S)),I=parseInt("0x"+k(t.slice(4+S,4+S+4))),o=H(t.slice(4+S+4,4+S+4+I));R({type:O==AG_CHATROOMMOONSERVER.cR?"recvChatPrivateMsg":"recvChatMsg",status:"success",fromUserId:i,msg:o});break;case AG_CHATROOMMOONSERVER.iR:R({type:"chatroomUserBannedMsg",status:"success",banTime:s=parseInt("0x"+k(t.slice(2,4)))});break;case AG_CHATROOMMOONSERVER.IR:R({type:"chatroomUserKicked",status:"success"});break;case AG_CHATROOMMOONSERVER.oR:R({type:"sendMsgNoFree"});break;case AG_CHATROOMMOONSERVER.AR:(o={}).errId=parseInt("0x"+k(t.slice(2,4))),o.errStrlen=parseInt("0x"+k(t.slice(4,6))),o.errStr=H(t.slice(6,6+o.errStrlen)),R({type:"serverErr",status:"failed",msg:o});break;case AG_CHATROOMMOONSERVER.NR:R({type:"getRoomOnlineNum",status:"success",roomId:E=H(t.slice(2,18)),onlineNum:parseInt("0x"+k(t.slice(18,22)))});break;case AG_CHATROOMMOONSERVER.lR:R({type:"saveToChatroomList",status:"success",roomId:E=H(t.slice(2,18))});break;case AG_CHATROOMMOONSERVER.fR:R({type:"saveToChatroomList",status:"failed",roomId:E=H(t.slice(2,18))});break;case AG_CHATROOMMOONSERVER.DR:R({type:"delFromToChatroomList",status:"success",roomId:E=H(t.slice(2,18))});break;case AG_CHATROOMMOONSERVER.UR:R({type:"delFromToChatroomList",status:"failed",roomId:E=H(t.slice(2,18))});break;case AG_CHATROOMMOONSERVER.vR:var A=parseInt("0x"+k(t.slice(2,6)));R({type:"queryAllChatroomList",status:"success",listData:H(t.slice(6,6+A))})}},e.parseVoipMoonServerMessage=function(e,R){var t=new Uint8Array(e);switch(parseInt("0x"+k(t.slice(0,2)))){case AG_VOIPMOONSERVER.YR:R({type:"voipCallingAck",status:"success"});break;case AG_VOIPMOONSERVER.KR:var O=parseInt("0x"+k(t.slice(2,4)));R({type:"voipCalling",status:"success",fingerprint:H(t.slice(4,4+O))});break;case AG_VOIPMOONSERVER.WR:(a={}).errId=parseInt("0x"+k(t.slice(2,4))),a.errStrlen=parseInt("0x"+k(t.slice(4,6))),a.errStr=H(t.slice(6,6+a.errStrlen)),R({type:"voipCalling",status:"failed",msg:a});break;case AG_VOIPMOONSERVER.qR:O=parseInt("0x"+k(t.slice(2,4)));R({type:"voipResponseing",status:"success",fingerprint:H(t.slice(4,4+O))});break;case AG_VOIPMOONSERVER.JR:(a={}).errId=parseInt("0x"+k(t.slice(2,4))),a.errStrlen=parseInt("0x"+k(t.slice(4,6))),a.errStr=H(t.slice(6,6+a.errStrlen)),R({type:"voipResponseing",status:"failed",msg:a});break;case AG_VOIPMOONSERVER.QR:case AG_VOIPMOONSERVER.jR:break;case AG_VOIPMOONSERVER.XR:var a;(a={}).errId=parseInt("0x"+k(t.slice(2,4))),a.errStrlen=parseInt("0x"+k(t.slice(4,6))),a.errStr=H(t.slice(6,6+a.errStrlen)),R({type:"serverErr",status:"failed",msg:a})}},e.constructHeartBeatMsg=function(e){return new Uint8Array(J(W(e.toString(16))))}},StarRtc.StarConfig=function(){this.configModePulic=!1,this.configUseAEC=!1,this.msgServerUrl="ips2.starrtc.com",this.msgServerWebsocketPort="9904",this.chatRoomServerUrl="ips2.starrtc.com",this.chatRoomServerWebsocketPort="9907",this.srcServerUrl="ips2.starrtc.com",this.srcServerWebsocketPort="9929",this.srcServerWebrtcPort="10088",this.vdnServerUrl="ips2.starrtc.com",this.vdnServerWebsocketPort="9929",this.vdnServerWebrtcPort="10088",this.voipServerUrl="voip2.starrtc.com",this.voipServerPort="10086",this.voipServerWebsocketPort="10087",this.voipServerWebrtcPort="10088",this.loginServerUrl="ips2.starrtc.com",this.loginServerPort="9920",this.msgScheduleUrl="ips2.starrtc.com",this.msgSchedulePort="9904",this.chatRoomScheduleUrl="ips2.starrtc.com",this.chatRoomSchedulePort="9907",this.srcScheduleUrl="ips2.starrtc.com",this.srcSchedulePort="9929",this.vdnScheduleUrl="ips2.starrtc.com",this.vdnSchedulePort="9926",this.workServerUrl="https://api.starrtc.com/public",this.webrtcServerIP="123.103.93.74"},StarRtc.StarUserInfo=function(){this.agentId="",this.userId="",this.starUid="",this.starToken=""},StarRtc.StarStaticInterface=new function(){var S=this;S.reportRoom=function(e,R,t,O,a,E){var _=null,n=a.id.substring(16,33),s={};s.id=a.id,s.creator=a.creator,s.name=a.name;var r=function(e,R){switch(e.obj=S,R){case"connect success":_.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.GR,{roomId:n,listType:O,userDefineData:encodeURIComponent(JSON.stringify(s))},t)));break;case"connect failed":E&&E("failed");case"connect closed":_=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.t&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){r(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"saveToChatroomList":E&&E(e.status),_.close()}}},c="wss://"+e+":"+R;(_=new StarRtc.WebrtcWebsocket(r,null)).connect(c)},S.queryRoom=function(e,R,a,E,_){var n=null,s=function(e,R){switch(e.obj=S,R){case"connect success":n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.dR,{listTypes:E.toString(),userId:""},a)));break;case"connect failed":_&&_("failed",[]);case"connect closed":n=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.t&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){s(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"queryAllChatroomList":if(""==e.listData){_&&_(e.status,[]);break}for(var t=JSON.parse(e.listData).userDefineDataList.split(","),O=0;O<t.length;O++)t[O]=JSON.parse(decodeURIComponent(t[O]));_&&_(e.status,t),n.close()}}},t="wss://"+e+":"+R;(n=new StarRtc.WebrtcWebsocket(s,null)).connect(t)},S.delRoom=function(e,R,t,O,a,E){var _=null,n=a.id.substring(16,33),s=function(e,R){switch(e.obj=S,R){case"connect success":_.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.pR,{roomId:n,listType:O},t)));break;case"connect failed":E&&E("failed");case"connect closed":_=null;break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.t&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){s(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"delFromToChatroomList":E&&E(e.status),_.close()}}},r="wss://"+e+":"+R;(_=new StarRtc.WebrtcWebsocket(s,null)).connect(r)}},StarRtc.StarSDK=function(){var e="starRTC v1.1.0",n=this,a=null,E=null,_=0;n.starConfig=new StarRtc.StarConfig,n.starUser=new StarRtc.StarUserInfo;var s=null;n.version=function(){return console.log(e),e};var r=function(e,R){switch(R){case"connect success":n.startAuth(),a(e,R);break;case"connect failed":case"connect closed":s=null,a(e,R);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){switch(e.appid){case APP_PRODUCT_ID.R:StarRtc.AUtils.parseMessage(e.msgArr,r)}});break;case"onSingleMessage":null!=e.msgNode&&(c(e.msgNode,n.starUser),e.msgNode=void 0),e.msg=JSON.parse(e.msg);var t=R;if(0==e.msg.type)switch(e.msg.code){case AG_MSG_VOIP_CTRL.h:e.type="voipCall",t="onVoipMessage";break;case AG_MSG_VOIP_CTRL.F:e.type="voipRefuse",t="onVoipMessage";break;case AG_MSG_VOIP_CTRL.K:e.type="voipHangup",t="onVoipMessage";break;case AG_MSG_VOIP_CTRL.W:e.type="voipBusy",t="onVoipMessage";break;case AG_MSG_VOIP_CTRL.B:e.type="voipConnect",t="onVoipMessage";break;default:e.type="voipSingleMsg"}else e.type="voipSingleMsg";(null!=E?E:a)(e,t);break;case"onLoginMessage":if("success"==e.status){e.msgMaxLen;var O=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructHeartBeatMsg(AG_MSG.X));null!=s&&s.startHeartBeat(O,15e3)}case"onGroupMessage":case"onGroupPrivateMessage":case"onGroupPushMessage":case"onSystemPushMessage":null!=e.msgNode&&(c(e.msgNode,n.starUser),e.msgNode=void 0);case"onErrorMessage":case"onGetGroupList":case"onGetOnlineNumber":case"onGetGroupUserList":case"onGetAllUserList":case"onPushGroupSystemMsgFin":case"onPushSystemMsgFin":case"onUnsetGroupMsgIgnoreFin":case"onSetGroupMsgIgnoreFin":case"onRemoveGroupUserFin":case"onAddGroupUserFin":case"onDelGroupFin":case"onCreateGroupFin":case"onSendGroupMsgFin":null!=E&&E(e,R),a(e,R)}};function c(e,R){console.log("发送消息回执"),n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructReceivedMsg(e,R)))}return n.setMsgServerInfo=function(e,R){n.starConfig.msgServerUrl=e,n.starConfig.msgServerWebsocketPort=R},n.setChatRoomServerInfo=function(e,R){n.starConfig.chatRoomServerUrl=e,n.starConfig.chatRoomServerWebsocketPort=R},n.setSrcServerInfo=function(e,R,t){n.starConfig.srcServerUrl=e,n.starConfig.srcServerWebsocketPort=R,n.starConfig.srcServerWebrtcPort=t},n.setVdnServerInfo=function(e,R,t){n.starConfig.vdnServerUrl=e,n.starConfig.vdnServerWebsocketPort=R,n.starConfig.vdnServerWebrtcPort=t},n.setVoipServerInfo=function(e,R,t,O){n.starConfig.voipServerUrl=e,n.starConfig.voipServerPort=R,n.starConfig.voipServerWebsocketPort=t,n.starConfig.voipServerWebrtcPort=O},n.setConfigUseAEC=function(e){n.starConfig.configUseAEC=e},n.login=function(e,R,t){n.starConfig.configModePulic||(e="APPID-FREE"),n.starUser.agentId=e,n.starUser.userId=R,n.starUser.starUid=e+"_"+R,a=t,function(e){if("WebSocket"in window){n.starUser.agentId,n.starUser.userId,n.starUser.starUid;n.starConfig.configModePulic||(n.starUser.starToken="free",(s=new StarRtc.WebrtcWebsocket(e,null)).connect("wss://"+n.starConfig.msgServerUrl+":"+n.starConfig.msgServerWebsocketPort))}else console.log("当前浏览器 Not support websocket"),e({msg:"当前浏览器 Not support websocket"},"connect failed")}(r)},window.onbeforeunload=function(){n.logout()},n.logout=function(){null!=s&&(s.close(),s=null)},n.send=function(e){null!=s&&s.send(e)},n.startAuth=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructAuthMsg(n.starUser)))},n.sendSingleMsg=function(e,R,t,O){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructSingleMsg(e,++_,R,t,O,n.starUser)))},n.sendGroupMsg=function(e,R,t){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructGroupMsg(e,++_,R,t,n.starUser)))},n.sendSingleCtrlMsg=function(e,R,t,O){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructSingleCtrlMsg(e,++_,R,t,O,n.starUser)))},n.sendVoipCtrlMsg=function(e,R){var t="";R==AG_MSG_VOIP_CTRL.h&&(t=JSON.stringify({VoIP_protocal_type:"TCP",VoIP_server_IP:n.starConfig.voipServerUrl,VoIP_server_Port:n.starConfig.voipServerPort})),n.sendSingleCtrlMsg(e,"新消息",t,R)},n.sendVoipCallMsg=function(e,R){var t,O=R||(new Date).getTime();t=JSON.stringify({VoIP_protocal_type:"TCP",VoIP_server_IP:n.starConfig.voipServerUrl,VoIP_server_Port:n.starConfig.voipServerPort,ts:O}),n.sendSingleCtrlMsg(e,"新消息",t,AG_MSG_VOIP_CTRL.h)},n.sendVoipRefuseMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.F)},n.sendVoipHungupMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.K),null!=E&&E({type:"voipCancle"},"onVoipMessage")},n.sendVoipBusyMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.W)},n.sendVoipConnectMsg=function(e){n.sendVoipCtrlMsg(e,AG_MSG_VOIP_CTRL.B)},n.setIMExtraback=function(e){E=e},n.getStarRoomSDK=function(e,R,t,O,a,E,_){return new StarRtc.StarRoomSDK(e,R,t,O,a,E,_,n.starUser,n.starConfig)},n.getVideoMeetingRoomSDK=function(e,R,t){return n.getStarRoomSDK("src",e,R,t,3,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING)},n.getVideoLiveRoomSDK=function(e,R,t,O){return n.getStarRoomSDK(e,R,t,O,3,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_LIVE)},n.getVoipRoomSDK=function(e,R,t){return n.getStarRoomSDK("voip",e,R,t,2,0,n)},n.getChatRoomSDK=function(e,R,t){return new StarRtc.StarChatRoomSDK(e,R,t,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,n.starUser,n.starConfig)},n.getVideoRoomSDK=function(e,R,t,O,a){return new StarRtc.StarVideoRoomSDK(e,R,t,O,a,n.starUser,n.starConfig)},n.queryVideoClassRoom=function(e){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.queryRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CLASS.toString()+","+CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CLASS_PUSH.toString(),e)},n.queryRoom=function(e,R){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.queryRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e.join(","),R)},n.setGroupMsgPush=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(e?AG_MSG.ae:AG_MSG.Ee,{reqIndex:0},n.starUser)))},n.removeGroupUsers=function(e,R){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.Oe,{reqIndex:0,groupId:e,removeUsers:R.join(",")},n.starUser)))},n.addGroupUsers=function(e,R,t){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.te,{reqIndex:0,groupId:e,addUsers:R.join(","),userDefineData:t},n.starUser)))},n.delGroup=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.Re,{reqIndex:0,groupId:e},n.starUser)))},n.createGroup=function(e,R){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ee,{reqIndex:0,addUsers:e.join(","),userDefineData:R},n.starUser)))},n.getGroupList=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.de,{reqIndex:0},n.starUser)))},n.getGroupUserList=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.be,{reqIndex:0,groupId:e},n.starUser)))},n.getOnlineNumber=function(){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ke,{},n.starUser)))},n.getAllUserList=function(e){n.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.R,ACTION_GROUP_ID.M,StarRtc.AUtils.constructMsgProtocol(AG_MSG.ge,{reqPageNum:e},n.starUser)))},n.getSuperRoomSDK=function(e,R,t){return new StarRtc.StarSuperRoomSDK(e,R,t,n.starUser,n.starConfig)},n.reportRoom=function(e,R,t){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.reportRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e,R,t)},n.delRoom=function(e,R,t){n.starConfig.configUseAEC||StarRtc.StarStaticInterface.reportRoom(n.starConfig.chatRoomServerUrl,n.starConfig.chatRoomServerWebsocketPort,n.starUser,e,R,t)},n},StarRtc.WebrtcWebsocket=function(e,R){var O,t=this,a=e,E=null;return t.startHeartBeat=function(e,R){var t=R||5e3;E.send(e),O=setInterval(function(){E.send(e)},t)},t.stopHeartBeat=function(){clearInterval(O)},t.connect=function(e){console.log("webrtcConnect"+e),(E=new WebSocket(e)).onerror=function(e){console.log("WebSocket连接发生错误"),a({msg:"WebSocket连接发生错误",data:e.data},"connect failed")},E.onopen=function(){console.log("WebSocket连接成功"),a({msg:"WebSocket连接成功"},"connect success")},E.onmessage=function(e){console.log("onmessage",e.data),a(e.data,"onmessage")},E.onclose=function(e){console.log("WebSocket连接关闭"),t.stopHeartBeat(),a({msg:"WebSocket连接关闭",data:e.code},"connect closed"),E=null}},t.send=function(e){E.send(e)},t.close=function(){null!=E&&E.close()},t.readyState=function(){return null!=E?E.readyState:-1},t},StarRtc.StarSuperRoomSDK=function(e,R,t,O,a){var E=this,_=e,n=t,s=R,r=null,c=null,S=null,i=null,I=null,o=null,A=!1,N=O||new StarRtc.StarUserInfo,M=a||new StarRtc.StarConfig;function V(e){if(null!=e){var R=e.getState();0<=R&&R<2&&e.sigDisconnect()}}function C(){return!(3!=I.getState()&&-1!=I.getState()||3!=S.getState()&&-1!=S.getState()||null!=r&&(null==r||3!=r.getState()&&-1!=r.getState()))}var u=function(e,R,t){switch(e.userData=n,e.obj=E,R){case"connect success":switch(t){case"open":r.createStream({video:!1,audio:{deviceId:{ideal:["default"]}}});break;case"new":r.createNewSuperRoom()}break;case"connect closed":case"connect failed":r=null;break;case"onmessage":break;case"onWebrtcMessage":switch(e.type){case"srcApplyUpload":s(e,R,_);break;case"streamCreated":"success"==e.status?r.joinRoom():s(e,R,_);break;case"delChannel":"success"==e.status?s(e,R,_):alert("删除视频会议失败");break;case"createChannel":"success"==e.status&&(n.roomInfo.creator=N.userId,n.roomInfo.id=e.channelId+n.roomInfo.id,i.roomInfo.id=e.channelId,i.roomInfo.creator=N.userId,c.roomInfo.id=e.channelId,c.roomInfo.creator=N.userId,r.sigDisconnect()),s(e,R,_)}}};return c=clone(n),i=clone(n),o=clone(n),n.roomInfo.id&&(c.roomInfo.id=n.roomInfo.id.substring(0,16),i.roomInfo.id=n.roomInfo.id.substring(0,16),o.roomInfo.id=n.roomInfo.id.substring(16,33)),S=new StarRtc.StarVideoSDK("vdn","open",function(e,R){switch(e.userData=n,e.obj=E,R){case"connect success":s(e,R,_);break;case"connect closed":case"connect failed":V(I),V(r),C()&&s(e,R,_);break;case"onmessage":break;case"onWebrtcMessage":e.type,s(e,R,_)}},i,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M),I=new StarRtc.StarChatSDK(e,function(e,R){switch(e.userData=n,e.obj=E,R){case"connect success":S.sigConnect();break;case"connect failed":case"connect closed":V(S),C()&&s(e,R,_);break;case"onmessage":break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(n.roomInfo.id=e.chatroomId,n.roomInfo.creator=N.userId,c.roomInfo.chatroomId=e.chatroomId,i.roomInfo.chatroomId=e.chatroomId,(r=new StarRtc.StarVideoSDK("src","new",u,c,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M)).sigConnect());break;case"deleteChatRoom":"success"==e.status&&r.deleteCurrRoom();break;case"joinChatRoom":"success"==e.status&&S.joinRoom()}s(e,R,_)}},o,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M),E.sigConnect=function(){A=!1,I.sigConnect()},E.sigDisconnect=function(e){null==e&&(e=!0),A=e,E.endTalk(e),S.sigDisconnect(e)},E.createNew=function(){I.createNew()},E.deleteCurrRoom=function(){I.deleteCurrRoom()},E.createStream=function(e){null==e?e={video:!1,audio:{deviceId:{ideal:["default"]}}}:e.video=!1,S.createStream(e)},E.joinRoom=function(){"new"!=_?I.joinRoom():S.joinRoom()},E.leaveRoom=function(e){E.endTalk(),S.leaveRoom(e)},E.sendChatMsg=function(e){I.sendChatMsg(e)},E.sendChatPrivateMsg=function(e,R){I.sendChatPrivateMsg(e,R)},E.kickOutUser=function(e){I.kickOutUser(e)},E.banToSendMsg=function(e,R){I.banToSendMsg(e,R)},E.getRoomOnlineNum=function(){I.getRoomOnlineNum()},E.activeDisconnect=function(){return A},E.startTalk=function(){null==r&&(r=new StarRtc.StarVideoSDK("src","open",u,c,CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_SUPER_ROOM,N,M)).sigConnect()},E.endTalk=function(){null!=r&&(r.sigDisconnect(),r=null)},E},StarRtc.StarRoomSDK=function(e,R,t,O,a,E,_,n,s){var r="我要上麦！",c=this,S=n||new StarRtc.StarUserInfo,i=s||new StarRtc.StarConfig,I=R,o=e,A=O,N=t,M=a||3,V=0!=(1&M),C=0!=(2&M);"open"==R&&32!=A.roomInfo.id.length&&(V=!1);var u=null,T=null,P=null,L=null,G=!1,l=null,f=_;function p(){null!=l&&(clearInterval(l),l=null)}function D(e){if(null!=e){var R=e.getState();0<=R&&R<2&&e.sigDisconnect()}}function U(){var e=!0;return V&&(e=e&&(3==P.getState()||-1==P.getState())),C&&(e=e&&(3==u.getState()||-1==u.getState())),e}null!=f&&"voip"==e&&f.setIMExtraback(function(e,R){d(e,"onVoipMessage")});var d=function(e,R){switch(e.userData=A,e.obj=c,R){case"connect success":C?u.sigConnect():N(e,R,I);break;case"connect failed":case"connect closed":C&&D(u),U()&&N(e,R,I);break;case"onmessage":break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(A.roomInfo.id=e.chatroomId,A.roomInfo.creator=S.userId,C&&(T.roomInfo.chatroomId=e.chatroomId,u.createNew()));break;case"deleteChatRoom":"success"==e.status&&(C?u.deleteCurrRoom():N(e,R,I));break;case"joinChatRoom":"success"==e.status&&C&&u.joinRoom();break;case"recvChatPrivateMsg":if(0==e.msg.type)switch(e.msg.code){case 2e3:e.msg.msgType="apply";break;case 2002:e.msg.msgType="applyAgree";break;case 2004:e.msg.msgType="applyDisagree";break;case 2200:e.msg.msgType="linkStop";break;case 2100:e.msg.msgType="invite";break;case 2102:e.msg.msgType="inviteAgree";break;case 2106:e.msg.msgType="inviteDisagree";break;case 2104:e.msg.msgType="inviteLinkStart";break;default:e.msg.msgType="common"}}N(e,R,I);break;case"onVoipMessage":switch(e.type){case"voipCall":e.fromId!=A.roomInfo.targetId&&f.sendVoipBusyMsg(e.fromId);break;case"voipHangup":e.fromId==A.roomInfo.targetId&&(c.leaveRoom(!0),N(e,R,I));break;case"voipBusy":p(),c.leaveRoom(!0),N(e,R,I);break;case"voipConnect":case"voipRefuse":p(),N(e,R,I);break;case"voipCancle":p();break;default:N(e,R,I)}}};return T=clone(A),L=clone(A),C&&V&&A.roomInfo.id&&(T.roomInfo.id=A.roomInfo.id.substring(0,16),L.roomInfo.id=A.roomInfo.id.substring(16,33)),C&&(u=new StarRtc.StarVideoSDK(e,R,function(e,R){switch(e.userData=A,e.obj=c,R){case"connect success":N(e,R,I);break;case"connect closed":case"connect failed":p(),V&&D(P),U()&&N(e,R,I);break;case"onmessage":break;case"onWebrtcMessage":switch(e.type){case"delChannel":"success"==e.status?N(e,R,I):alert("删除视频会议失败");break;case"createChannel":"success"==e.status&&(A.roomInfo.creator=S.userId,A.roomInfo.id=V?e.channelId+A.roomInfo.id:e.channelId),N(e,R,I);break;case"voipCallingAck":if(null!=f){p();var t=(new Date).getTime();f.sendVoipCallMsg(A.roomInfo.targetId,t),E=A.roomInfo.targetId,O=function(){f.sendVoipCallMsg(E,t)},a=3e3,null!=l&&p(),l=setInterval(O,a)}break;case"voipResponseing":"success"==e.status&&null!=f&&f.sendVoipConnectMsg(A.roomInfo.targetId),N(e,R,I);break;default:N(e,R,I)}}var O,a,E},T,E,S,i)),V&&(P=new StarRtc.StarChatSDK(R,d,L,E,S,i)),c.sigConnect=function(){G=!1,V?P.sigConnect():C&&u.sigConnect()},c.sigDisconnect=function(e){null==e&&(e=!0),G=e,C?u.sigDisconnect(e):V&&P.sigDisconnect(e)},c.createNew=function(){"voip"!=o&&(V?P.createNew():C&&u.createNew())},c.deleteCurrRoom=function(){"voip"!=o&&(V?P.deleteCurrRoom():C&&u.deleteCurrRoom())},c.createStream=function(e){C&&u.createStream(e)},c.createScreenCaptureStream=function(){C&&u.createScreenCaptureStream()},c.joinRoom=function(){V&&"new"!=I?P.joinRoom():C&&u.joinRoom()},c.leaveRoom=function(e){if(C){switch(o){case"voip":var R=e||!1;null==f||R||f.sendVoipHungupMsg(A.roomInfo.targetId),f.setIMExtraback(null)}u.leaveRoom(R)}else V&&P.leaveRoom()},c.streamConfigChange=function(e){C&&u.streamConfigChange(e)},c.sendChatMsg=function(e){V&&P.sendChatMsg(e)},c.sendVoipMsg=function(e){"voip"==o&&null!=f&&f.sendSingleMsg(A.roomInfo.targetId,"新媒体",e)},c.sendChatPrivateMsg=function(e,R){V&&P.sendChatPrivateMsg(e,R)},c.sendApplyMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2e3)},c.sendApplyAgreeMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2002)},c.sendApplyDisagreeMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2004)},c.sendInviteLinkMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2100)},c.sendInviteLinkAgreeMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2102)},c.sendInviteLinkDisagreeMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2106)},c.sendInviteLinkStartMsg=function(){V&&C&&"vdn"==o&&P.sendChatCtrlPrivateMsg(A.roomInfo.creator,r,2104)},c.sendLinkStopMsg=function(e){V&&C&&"src"==o&&P.sendChatCtrlPrivateMsg(e,r,2200)},c.kickOutUser=function(e){V&&P.kickOutUser(e)},c.banToSendMsg=function(e,R){V&&P.banToSendMsg(e,R)},c.getRoomOnlineNum=function(){V&&P.getRoomOnlineNum()},c.sendStreamData=function(e){C&&"src"==o&&u.sendStreamData(e)},c.activeDisconnect=function(){return G},c.getUserData=function(){return A},c.startLocalStream=function(e){C&&u.startLocalStream(e)},c},StarRtc.StarVideoRoomSDK=function(e,R,t,O,a,E,_){var n=this,s=O,r=t,c=R,S=e,i=a||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING,I=E||new StarRtc.StarUserInfo,o=_||new StarRtc.StarConfig,A=new StarRtc.StarVideoSDK(S,c,N,s,i,I,o),N=function(e,R){e.userData=s,e.obj=n,r(e,R,c)};return n.sigConnect=function(){A.sigConnect()},n.sigDisconnect=function(e){A.sigDisconnect(e)},n.createNew=function(){A.createNew()},n.createNewSuperRoom=function(){A.createNewSuperRoom()},n.deleteCurrRoom=function(){A.deleteCurrRoom()},n.createStream=function(e){A.createStream(e)},n.createScreenCaptureStream=function(){A.createScreenCaptureStream()},n.joinRoom=function(){A.joinRoom()},n.leaveRoom=function(e){A.leaveRoom(e)},n.streamConfigChange=function(e){A.streamConfigChange(e)},n.getState=function(){return A.getState()},n.getType=function(){return A.getType()},n.sendStreamData=function(e){A.sendStreamData(e)},n.activeDisconnect=function(){return A.activeDisconnect()},n},StarRtc.StarVideoSDK=function(e,R,t,O,a,E,_){var r,c,S=this,i=O,I=e,o=t,A=R,N=null,M="",V={},C={},u=E||new StarRtc.StarUserInfo,n=_||new StarRtc.StarConfig,s=a||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_MEETING,T={siv:0,uperInfos:{}},P=StarWebRTC();P.init();var L=!1,G=!1,l=function(e){switch(e.type){case"createOffer":if("success"==e.status){switch(I){case"src":e.channelId=i.roomInfo.id;break;case"vdn":e.ssrc=e.bigVideoSSRC;break;case"voip":e.targetId=i.roomInfo.targetId,e.videoSSRC=e.bigVideoSSRC}!function(e){switch(C=e,I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.hO,e,u)));break;case"vdn":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.BO,e,u)));break;case"voip":"call"==A?N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.mR,e,u))):"response"==A&&N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.wR,e,u)))}}(e)}break;case"applyAnswer":e.status}},f=function(e,R){var t={type:"streamCreated",streamObj:R};t.userData=i,t.obj=S,"success"==e?t.status="success":(t.status="failed",t.error=R),o(t,"onWebrtcMessage",A)},p=function(e,R){switch(e.userData=i,e.obj=S,R){case"connect success":var t=null;switch(I){case"src":t=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructHeartBeatMsg(AG_LIVESRCMOONSERVER.zt));break;case"vdn":t=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructHeartBeatMsg(AG_LIVEVDNMOONSERVER.QO))}N.startHeartBeat(t),P.setServerInfo({serverIp:V.ip,serverPort:V.webrtcPort}),o(e,R,A);break;case"connect failed":case"connect closed":P.destroy(),N=null,o(e,R,A);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.i?StarRtc.AUtils.parseSrcMoonServerMessage(e.msgArr,function(e){p(e,"onWebrtcMessage")}):e.appid==APP_PRODUCT_ID.I?StarRtc.AUtils.parseVdnMoonServerMessage(e.msgArr,function(e){p(e,"onWebrtcMessage")}):e.appid==APP_PRODUCT_ID.o&&StarRtc.AUtils.parseVoipMoonServerMessage(e.msgArr,function(e){p(e,"onWebrtcMessage")})});break;case"onWebrtcMessage":switch(e.type){case"uperStreamInfoUpdate":if("success"==e.status){if(L)for(var O=0;O<7;++O){var a=P.getStreamByIndex(O),E=void 0;0!=Object.keys(T.uperInfos).length&&(E=T.uperInfos[O]);var _=e.msg.uperInfos[O];if(null==E&&null!=_)"vdn"!=I&&_.userId==u.starUid||o({type:"addUploader",upId:_.upId,upUserId:_.userId,streamInfo:a,room:S},R,A);else if(null!=E&&null==_){var n=c==E.upId;n&&(c=r=void 0),P.resetStreamInfo(a),o({type:"removeUploader",upId:E.upId,upUserId:E.userId,streamInfo:a,bigFlag:n,room:S},R,A)}else null!=E&&null!=_&&E.userId!=_.userId&&o({type:"changeUploader",upId:_.upId,oldUpUserId:E.userId,newUpUserId:_.userId,streamInfo:a,room:S},R,A)}T=e.msg}break;case"webrtcConnect":if("success"==e.status)switch(I){case"vdn":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.qO,{channelId:i.roomInfo.id},u)));break;case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.Yt,C,u)))}break;case"webrtcReg":if("success"==e.status)switch(I){case"vdn":case"src":M=e.fingerprint,P.emit("_webrtc_apply_ok",M,function(){L=!0},102,111)}else console.log("webrtcReg failed");break;case"vdnApplyDownload":"success"==e.status?p({type:"uperStreamInfoUpdate",status:"success",msg:e.uperInfos},"onWebrtcMessage"):console.log("收到vdnApplyDownload failed"),o(e,R,A);break;case"srcApplyUpload":if("success"==e.status){e.tmpData=C,console.log("收到_webrtc_apply_ok");var s=clone(T);T.uperInfos={},p({type:"uperStreamInfoUpdate",status:"success",msg:s},"onWebrtcMessage")}else console.log("收到srcApplyUpload failed");o(e,R,A);break;case"streamConfig":if("success"==e.status){if(r==c){a=P.getStreamByIndex(r);P.switchStreamInfo(a);break}if(null!=r){a=P.getStreamByIndex(r);P.switchStreamInfo(a)}if(null!=c){a=P.getStreamByIndex(c);P.switchStreamInfo(a)}}break;case"createChannel":"success"==e.status&&(i.roomInfo.id=e.channelId,i.roomInfo.creator=u.userId),o(e,R,A);break;case"delChannel":"success"==e.status&&(i.roomInfo.id=""),o(e,R,A);break;case"serverErr":break;case"voipResponseing":case"voipCalling":"success"==e.status&&(console.log("收到_webrtc_apply_ok"),P.emit("_webrtc_apply_ok",e.fingerprint,function(){p({type:"voipStreamReady",status:"success"},"onWebrtcMessage")})),o(e,R,A);break;case"voipStreamReady":a=P.getStreamByIndex(0);P.switchStreamInfo(a),o({type:"voipStreamReady",streamObj:a.streamObj,room:S},R,A);break;case"streamInactive":S.leaveRoom(),S.sigDisconnect();break;default:o(e,R,A)}}};return S.sigConnect=function(){switch(G=!1,N=null,I){case"src":if(!n.configModePulic){N=new StarRtc.WebrtcWebsocket(p,null),(R={}).ip=n.srcServerUrl,V.ip=R.ip,V.websocketPort=n.srcServerWebsocketPort,V.webrtcPort=n.srcServerWebrtcPort,R.websocketPort=V.websocketPort;var e="wss://"+R.ip+":"+R.websocketPort;return void N.connect(e)}break;case"vdn":if(!n.configModePulic){N=new StarRtc.WebrtcWebsocket(p,null),(R={}).ip=n.vdnServerUrl,V.ip=R.ip,V.websocketPort=n.vdnServerWebsocketPort,V.webrtcPort=n.vdnServerWebrtcPort,R.websocketPort=V.websocketPort;e="wss://"+R.ip+":"+R.websocketPort;return void N.connect(e)}break;case"voip":var R;N=new StarRtc.WebrtcWebsocket(p,null),(R={}).ip=n.voipServerUrl,V.ip=R.ip,V.websocketPort=n.voipServerWebsocketPort,V.webrtcPort=n.voipServerWebrtcPort,R.websocketPort=V.websocketPort;e="wss://"+R.ip+":"+R.websocketPort;return void N.connect(e);default:return}},S.sigDisconnect=function(e){null==e&&(e=!0),G=e,null!=N&&(N.close(),N=null)},S.createNew=function(){if(null!=N)switch(I){case"src":var e=AG_LIVESRCMOONSERVER.kt;1==i.roomInfo.Type&&(e=AG_LIVESRCMOONSERVER.gt),N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(e,{conCurrentNum:7,roomId:i.roomInfo.chatroomId||"",extra:i.roomInfo.name,liveType:s},u)))}},S.createNewSuperRoom=function(){if(null!=N)switch(I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.FO,{conCurrentNum:7,roomId:i.roomInfo.chatroomId||"",extra:i.roomInfo.name,liveType:s},u)))}},S.deleteCurrRoom=function(){if(null!=N)switch(I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.Jt,{channelId:i.roomInfo.id},u)))}},S.createStream=function(e){null==e&&(e={video:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:25},facingMode:{ideal:["user"]}},audio:{deviceId:{ideal:["default"]}}}),"vdn"==I&&(e={video:!1,audio:!1}),P.createStream(e,f,function(){p({type:"streamInactive"},"onWebrtcMessage")})},S.createScreenCaptureStream=function(){P.createScreenCaptureStream(f,function(){p({type:"streamInactive"},"onWebrtcMessage")})},S.joinRoom=function(){P.emit("ready",l,"voip"==I)},S.leaveRoom=function(e){if(null!=N&&1==N.readyState())switch(I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.qt,{channelId:i.roomInfo.id},u)));break;case"vdn":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.JO,{},u)));case"voip":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.o,ACTION_GROUP_ID.T,StarRtc.AUtils.constructVOIPProtocol(AG_VOIPMOONSERVER.xR,{isActive:e?0:1},u)))}},S.streamConfigChange=function(e){if(null!=N){c==e?(c=r,r=e):(r=c,c=e);var R=P.getStreamInfos(),t=[];for(var O in R){var a=0;a=r==c?R[O].switchFlag?1:2:O==r?1:O==c?2:R[O].switchFlag?2:1,t.push(a)}switch(I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.Qt,{streamConfig:t},u)));break;case"vdn":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.I,ACTION_GROUP_ID.u,StarRtc.AUtils.constructVdnProtocol(AG_LIVEVDNMOONSERVER.XO,{streamConfig:t},u)))}}},S.getState=function(){return null!=N?N.readyState():-1},S.getType=function(){return I},S.sendStreamData=function(e){switch(I){case"src":N.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.i,ACTION_GROUP_ID.u,StarRtc.AUtils.constructSrcProtocol(AG_LIVESRCMOONSERVER.Xt,{streamData:e,streamDataType:8},u)))}},S.activeDisconnect=function(){return G},S.startLocalStream=function(e){P.startLocalStream(e)},S},StarRtc.StarChatRoomSDK=function(e,R,t,O,a,E){var _=this,n=t,s=R,r=e,c=(O||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,a||new StarRtc.StarUserInfo),S=E||new StarRtc.StarConfig,i=new StarRtc.StarChatSDK(e,I,n,O,c,S),I=function(e,R){switch(e.userData=n,e.obj=_,R){case"onChatRoomMessage":e.type,s(e,R,r);break;default:s(e,R,r)}};return _.sigConnect=function(){i.sigConnect()},_.sigDisconnect=function(e){i.sigDisconnect(e)},_.createNew=function(){i.createNew()},_.sendChatMsg=function(e){i.sendChatMsg(e)},_.sendChatPrivateMsg=function(e,R){i.sendChatPrivateMsg(e,R)},_.sendChatCtrlPrivateMsg=function(e,R,t){i.sendChatCtrlPrivateMsg(e,R,t)},_.kickOutUser=function(e){i.kickOutUser(e)},_.banToSendMsg=function(e,R){i.banToSendMsg(e,R)},_.getRoomOnlineNum=function(){i.getRoomOnlineNum()},_.deleteCurrRoom=function(){i.deleteCurrRoom()},_.joinRoom=function(){i.joinRoom()},_.leaveRoom=function(){i.leaveRoom()},_.getState=function(){return i.getState()},_.activeDisconnect=function(){return i.activeDisconnect()},_},StarRtc.StarChatSDK=function(e,R,t,O,a,E){var _=this,n={},s=t,r=R,c=e,S=null,i=0,I=O||CHATROOM_LIST_TYPE.CHATROOM_LIST_TYPE_CHATROOM,o=a||new StarRtc.StarUserInfo,A=E||new StarRtc.StarConfig,N=!1,M=function(e,R){switch(e.userData=s,e.obj=_,R){case"connect success":var t;t=StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructHeartBeatMsg(AG_CHATROOMMOONSERVER.Be)),S.startHeartBeat(t),r(e,R,c);break;case"connect failed":case"connect closed":S=null,r(e,R,c);break;case"onmessage":StarRtc.AUtils.parseProtocol(e,function(e){e.appid==APP_PRODUCT_ID.t&&StarRtc.AUtils.parseChatMoonServerMessage(e.msgArr,function(e){M(e,"onChatRoomMessage")})});break;case"onChatRoomMessage":switch(e.type){case"createChatRoom":"success"==e.status&&(s.roomInfo.id=e.chatroomId,s.roomInfo.creator=o.userId);break;case"deleteChatRoom":case"joinChatRoom":e.status;break;case"recvChatPrivateMsg":case"recvChatMsg":if(""==e.fromUserId||""==e.msg)return;if(e.msg=JSON.parse(e.msg),e.msg.fromId==o.userId)return}r(e,R,c)}};return _.sigConnect=function(){if(N=!1,A.configModePulic);else{S=new StarRtc.WebrtcWebsocket(M,null),n.ip=A.chatRoomServerUrl,n.port=A.chatRoomServerWebsocketPort;var e="wss://"+n.ip+":"+n.port;S.connect(e)}},_.sigDisconnect=function(e){null==e&&(e=!0),N=e,null!=S&&(S.close(),S=null)},_.createNew=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Ye,{roomType:0==s.roomInfo.Type?1:2,conCurrentNum:100,userDefineData:s.roomInfo.name,liveType:I},o)))},_.sendChatMsg=function(e){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.je,{roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:e},o)))},_.sendChatPrivateMsg=function(e,R){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Xe,{toUserId:e,roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:R,type:"1",code:"0"},o)))},_.sendChatCtrlPrivateMsg=function(e,R,t){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Xe,{toUserId:e,roomId:s.roomInfo.id,digest:"新消息",msgIndex:++i,msg:R,type:"0",code:t},o)))},_.kickOutUser=function(e){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.We,{kickOutUserId:e},o)))},_.banToSendMsg=function(e,R){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Ke,{banUserId:e,banTime:R},o)))},_.getRoomOnlineNum=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.ze,{roomId:s.roomInfo.id},o)))},_.deleteCurrRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Fe,{},o)))},_.joinRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.qe,{roomId:s.roomInfo.id},o)))},_.leaveRoom=function(){S.send(StarRtc.AUtils.packageProtocol(APP_PRODUCT_ID.t,ACTION_GROUP_ID.V,StarRtc.AUtils.constructChatProtocol(AG_CHATROOMMOONSERVER.Qe,{},o)))},_.getState=function(){return null!=S?S.readyState():-1},_.activeDisconnect=function(){return N},_},module.exports=exports=StarRtc;